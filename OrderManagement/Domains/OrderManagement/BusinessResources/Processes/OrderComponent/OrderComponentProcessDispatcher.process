<?xml version="1.0" encoding="UTF-8"?>
<pd:ProcessDefinition xmlns:BW="java://com.tibco.pe.core.JavaCustomXPATHFunctions" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:ns="http://vodafone.com.tr/EAI/Common/Header" xmlns:ns9="http://vodafone.com.tr/OrderManagment/Business/OrderComponent/OrderComponentResponseInput/v1" xmlns:ns12="http://vodafone.com.tr/OrderManagement/Domains/OrderManagement/CommonResources/Schemas/OrderManagement/Schema.xsd" xmlns:ns5="http://www.tibco.com/schemas/OrderManagement/Domains/OrderManagement/BusinessResources/Schemas/FR/Schema.xsd2" xmlns:ns6="http://vodafone.com.tr/OrderManagment/Business/FR/FRRequestInput/v1" xmlns:ns10="http://vodafone.com.tr/ServiceCatalog/ServiceReply" xmlns:ns7="http://vodafone.com.tr/EAI/Common/ResponseEAI" xmlns:pfx="http://vodafone.com.tr/EAI/Common/RequestEAI" xmlns:ns11="http://vodafone.com.tr/OrderManagment/Business/OrderComponent/OrderComponentRequestInput/v1" xmlns:ns8="http://vodafone.com.tr/EAI/Common/ResponseCodes" xmlns:ns2="http://www.tibco.com/pe/DeployedVarsType" xmlns:pd="http://xmlns.tibco.com/bw/process/2003" xmlns:ns1="http://www.tibco.com/pe/EngineTypes" xmlns:ns4="urn:com:metasolv:oms:xmlapi:1" xmlns:ns3="http://vodafone.com.tr/EAI/Logging" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tib="http://www.tibco.com/bw/xslt/custom-functions" xmlns:pfx4="http://vodafone.com.tr/ServiceCatalog/ServiceRequest" xmlns:pfx3="http://www.tibco.com/pe/GenerateErrorActivity/InputSchema" xmlns:pfx2="http://www.tibco.com/schemas/OrderManagement/Domains/OrderManagement/CommonResources/Schemas/OrderManagement/Schema.xsd">
    <xsd:import namespace="http://vodafone.com.tr/EAI/Common/RequestEAI" schemaLocation="/GlobalCommonResources/Schemas/Common/RequestEAI.xsd"/>
    <xsd:import namespace="http://vodafone.com.tr/OrderManagment/Business/FR/FRRequestInput/v1" schemaLocation="/Domains/OrderManagement/BusinessResources/Schemas/FR/FRRequestInput.xsd"/>
    <xsd:import namespace="urn:com:metasolv:oms:xmlapi:1" schemaLocation="/Domains/OrderManagement/BusinessResources/Schemas/OSM/OSM_OperationResponse.xsd"/>
    <xsd:import namespace="http://vodafone.com.tr/EAI/Common/ResponseEAI" schemaLocation="/GlobalCommonResources/Schemas/Common/ResponseEAI.xsd"/>
    <xsd:import namespace="urn:com:metasolv:oms:xmlapi:1" schemaLocation="/Domains/OrderManagement/BusinessResources/Schemas/OSM/OSM_OperationRequest.xsd"/>
    <xsd:import namespace="http://vodafone.com.tr/OrderManagment/Business/OrderComponent/OrderComponentRequestInput/v1" schemaLocation="/Domains/OrderManagement/BusinessResources/Schemas/OrderComponent/OrderComponentRequestInput.xsd"/>
    <xsd:import namespace="http://vodafone.com.tr/OrderManagment/Business/OrderComponent/OrderComponentResponseInput/v1" schemaLocation="/Domains/OrderManagement/BusinessResources/Schemas/OrderComponent/OrderComponentResponseInput.xsd"/>
    <xsd:import namespace="http://vodafone.com.tr/ServiceCatalog/ServiceRequest" schemaLocation="/Domains/ServiceCatalog/BusinessResources/Schemas/ServiceRequest.xsd"/>
    <xsd:import namespace="http://vodafone.com.tr/ServiceCatalog/ServiceReply" schemaLocation="/Domains/ServiceCatalog/BusinessResources/Schemas/ServiceReply.xsd"/>
    <pd:name>Domains/OrderManagement/BusinessResources/Processes/OrderComponent/OrderComponentProcessDispatcher.process</pd:name>
    <pd:startName>Start</pd:startName>
    <pd:startType>
        <xsd:element name="Input">
            <xsd:complexType>
                <xsd:sequence>
                    <xsd:element ref="pfx:RequestEAI"/>
                </xsd:sequence>
            </xsd:complexType>
        </xsd:element>
    </pd:startType>
    <pd:startX>84</pd:startX>
    <pd:startY>197</pd:startY>
    <pd:returnBindings/>
    <pd:endName>End</pd:endName>
    <pd:endX>1007</pd:endX>
    <pd:endY>199</pd:endY>
    <pd:errorSchemas/>
    <pd:processVariables>
        <Response ref="ns7:ResponseEAI"/>
    </pd:processVariables>
    <pd:targetNamespace>http://vodafone.com.tr/1399043016876</pd:targetNamespace>
    <pd:activity name="Assign Error">
        <pd:type>com.tibco.pe.core.AssignActivity</pd:type>
        <pd:resourceType>ae.activities.assignActivity</pd:resourceType>
        <pd:x>387</pd:x>
        <pd:y>560</pd:y>
        <config>
            <variableName>Response</variableName>
        </config>
        <pd:inputBindings>
            <ns7:ResponseEAI>
                <ns7:Header>
                    <xsl:copy-of select="$SetHeader/Output/Header/ancestor-or-self::*/namespace::node()"/>
                    <xsl:copy-of select="$SetHeader/Output/Header/@*"/>
                    <xsl:copy-of select="$SetHeader/Output/Header/node()"/>
                </ns7:Header>
                <xsl:choose>
                    <xsl:when test="string-length($Catch-LogMessage/ns3:LogMessage) > 0">
                        <ns7:ResponseCodes>
                            <ns8:ResponseCode>
                                <xsl:value-of select="$Catch-LogMessage/ns3:LogMessage/ns3:ResponseCode"/>
                            </ns8:ResponseCode>
                            <xsl:if test="$Catch-LogMessage/ns3:LogMessage/ns3:ErrorCode">
                                <ns8:ErrorCode>
                                    <xsl:value-of select="$Catch-LogMessage/ns3:LogMessage/ns3:ErrorCode"/>
                                </ns8:ErrorCode>
                            </xsl:if>
                            <xsl:if test="$Catch-LogMessage/ns3:LogMessage/ns3:Description">
                                <ns8:ErrorDescription>
                                    <xsl:value-of select="$Catch-LogMessage/ns3:LogMessage/ns3:Description"/>
                                </ns8:ErrorDescription>
                            </xsl:if>
                        </ns7:ResponseCodes>
                    </xsl:when>
                    <xsl:otherwise>
                        <ns7:ResponseCodes>
                            <ns8:ResponseCode>
                                <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/ErrorCodes/TransportError"/>
                            </ns8:ResponseCode>
                            <ns8:ResponseMsg>
                                <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/ErrorCodes/TransportErrorDescription"/>
                            </ns8:ResponseMsg>
                            <xsl:choose>
                                <xsl:when test="$_error/ns1:ErrorReport/Msg='failed to execute called process'">
                                    <ns8:ErrorCode>
                                        <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/ErrorCodes/InternalError"/>
                                    </ns8:ErrorCode>
                                </xsl:when>
                                <xsl:otherwise>
                                    <ns8:ErrorCode>
                                        <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/ErrorCodes/TransportError"/>
                                    </ns8:ErrorCode>
                                </xsl:otherwise>
                            </xsl:choose>
                            <xsl:choose>
                                <xsl:when test="$_error/ns1:ErrorReport/Msg='failed to execute called process'">
                                    <ns8:ErrorDescription>
                                        <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/ErrorCodes/InternalErrorDescription"/>
                                    </ns8:ErrorDescription>
                                </xsl:when>
                                <xsl:otherwise>
                                    <ns8:ErrorDescription>
                                        <xsl:value-of select="concat ($_error/ns1:ErrorReport/Msg,' || ', substring($_error/ns1:ErrorReport/StackTrace,1,996 - string-length($_error/ns1:ErrorReport/Msg)))"/>
                                    </ns8:ErrorDescription>
                                </xsl:otherwise>
                            </xsl:choose>
                        </ns7:ResponseCodes>
                    </xsl:otherwise>
                </xsl:choose>
            </ns7:ResponseEAI>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Catch-All">
        <pd:type>com.tibco.pe.core.CatchActivity</pd:type>
        <pd:resourceType>ae.activities.catch</pd:resourceType>
        <pd:x>229</pd:x>
        <pd:y>630</pd:y>
        <pd:handler>true</pd:handler>
        <config>
            <catchAll>true</catchAll>
        </config>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="Catch-LogMessage">
        <pd:type>com.tibco.pe.core.CatchActivity</pd:type>
        <pd:resourceType>ae.activities.catch</pd:resourceType>
        <pd:x>228</pd:x>
        <pd:y>482</pd:y>
        <pd:handler>true</pd:handler>
        <config>
            <fault>localname=LogMessage namespace=http://vodafone.com.tr/EAI/Logging</fault>
        </config>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="Fail Order Component">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>791</pd:x>
        <pd:y>372</pd:y>
        <config>
            <processName>/Domains/OrderManagement/BusinessResources/Processes/OrderComponent/OrderComponentResponse.process</processName>
        </config>
        <pd:inputBindings>
            <Input>
                <xsl:choose>
                    <xsl:when test="string-length($GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]) = 0&#xA;or&#xA;string-length($_error/ns1:ErrorReport/StackTrace[1]) > 0">
                        <ns9:Request>
                            <ns9:OcDetails>
                                <ns9:Id>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Id"/>
                                </ns9:Id>
                                <ns9:Name>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                                </ns9:Name>
                                <ns9:Scenario>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Scenario"/>
                                </ns9:Scenario>
                                <ns9:OrderId>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:OrderId"/>
                                </ns9:OrderId>
                                <ns9:CorrelationID>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute[ns:Name = $_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/CorrelationID]/ns:Value"/>
                                </ns9:CorrelationID>
                                <xsl:for-each select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Cartridge">
                                    <ns9:Cartridge>
                                        <ns9:Name>
                                            <xsl:value-of select="ns4:Name"/>
                                        </ns9:Name>
                                        <ns9:Version>
                                            <xsl:value-of select="ns4:Version"/>
                                        </ns9:Version>
                                        <ns9:Source>
                                            <xsl:value-of select="ns4:Source"/>
                                        </ns9:Source>
                                    </ns9:Cartridge>
                                </xsl:for-each>
                            </ns9:OcDetails>
                            <ns9:ServiceReply>
                                <ns10:Header>
                                    <ns8:ResponseCode>
                                        <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/ErrorCodes/ReferenceDataNotFound"/>
                                    </ns8:ResponseCode>
                                </ns10:Header>
                                <ns10:Body>
                                    <ns4:TelcoOperationResponse>
                                        <Id>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Id"/>
                                        </Id>
                                        <Name>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                                        </Name>
                                        <OrderId>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:OrderId"/>
                                        </OrderId>
                                        <StatusCode>
                                            <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/ErrorCodes/ReferenceDataNotFound"/>
                                        </StatusCode>
                                        <xsl:choose>
                                            <xsl:when test="string-length($_error/ns1:ErrorReport/StackTrace)>0">
                                                <StatusMessage>
                                                    <xsl:value-of select="concat(&quot;GetOrderManagementRoute&quot;,$_error/ns1:ErrorReport/Msg)"/>
                                                </StatusMessage>
                                            </xsl:when>
                                            <xsl:otherwise>
                                                <StatusMessage>
                                                    <xsl:value-of select="&quot;Could not find Service Routing for the given OC&quot;"/>
                                                </StatusMessage>
                                            </xsl:otherwise>
                                        </xsl:choose>
                                    </ns4:TelcoOperationResponse>
                                </ns10:Body>
                            </ns9:ServiceReply>
                        </ns9:Request>
                    </xsl:when>
                    <xsl:otherwise>
                        <ns9:Request>
                            <ns9:OcDetails>
                                <ns9:Id>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Id"/>
                                </ns9:Id>
                                <ns9:Name>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                                </ns9:Name>
                                <ns9:Scenario>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Scenario"/>
                                </ns9:Scenario>
                                <ns9:OrderId>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:OrderId"/>
                                </ns9:OrderId>
                                <ns9:CorrelationID>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute[ns:Name = $_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/CorrelationID]/ns:Value"/>
                                </ns9:CorrelationID>
                                <xsl:for-each select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Cartridge">
                                    <ns9:Cartridge>
                                        <ns9:Name>
                                            <xsl:value-of select="ns4:Name"/>
                                        </ns9:Name>
                                        <ns9:Version>
                                            <xsl:value-of select="ns4:Version"/>
                                        </ns9:Version>
                                        <ns9:Source>
                                            <xsl:value-of select="ns4:Source"/>
                                        </ns9:Source>
                                    </ns9:Cartridge>
                                </xsl:for-each>
                            </ns9:OcDetails>
                            <ns9:ServiceReply>
                                <ns10:Header>
                                    <ns8:ResponseCode>
                                        <xsl:value-of select="$Order-Component-Dispacher/Output/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseCode"/>
                                    </ns8:ResponseCode>
                                </ns10:Header>
                                <ns10:Body>
                                    <ns4:TelcoOperationResponse>
                                        <Id>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Id"/>
                                        </Id>
                                        <Name>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                                        </Name>
                                        <OrderId>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:OrderId"/>
                                        </OrderId>
                                        <StatusCode>
                                            <xsl:value-of select="$Order-Component-Dispacher/Output/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseCode"/>
                                        </StatusCode>
                                        <StatusMessage>
                                            <xsl:value-of select="tib:left(concat($Order-Component-Dispacher/Output/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseMsg,': ', $Order-Component-Dispacher/Output/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ErrorDescription), 1000)"/>
                                        </StatusMessage>
                                    </ns4:TelcoOperationResponse>
                                </ns10:Body>
                            </ns9:ServiceReply>
                        </ns9:Request>
                    </xsl:otherwise>
                </xsl:choose>
            </Input>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Fail Order Component - 1">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>742</pd:x>
        <pd:y>573</pd:y>
        <config>
            <processName>/Domains/OrderManagement/BusinessResources/Processes/OrderComponent/OrderComponentResponse.process</processName>
        </config>
        <pd:coercions>
            <pd:coercion xpath="$Start/Input/pfx:RequestEAI/pfx:Body/*" element="ns4:TelcoOperationRequest"/>
        </pd:coercions>
        <pd:inputBindings>
            <Input>
                <ns9:Request>
                    <ns9:OcDetails>
                        <ns9:Id>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Id"/>
                        </ns9:Id>
                        <ns9:Name>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                        </ns9:Name>
                        <ns9:Scenario>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Scenario"/>
                        </ns9:Scenario>
                        <ns9:OrderId>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:OrderId"/>
                        </ns9:OrderId>
                        <ns9:CorrelationID>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute[ns:Name = $_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/CorrelationID]/ns:Value"/>
                        </ns9:CorrelationID>
                        <xsl:for-each select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Cartridge">
                            <ns9:Cartridge>
                                <ns9:Name>
                                    <xsl:value-of select="ns4:Name"/>
                                </ns9:Name>
                                <ns9:Version>
                                    <xsl:value-of select="ns4:Version"/>
                                </ns9:Version>
                                <ns9:Source>
                                    <xsl:value-of select="ns4:Source"/>
                                </ns9:Source>
                            </ns9:Cartridge>
                        </xsl:for-each>
                    </ns9:OcDetails>
                    <ns9:ServiceReply>
                        <ns10:Header>
                            <ns8:ResponseCode>
                                <xsl:value-of select="$Response/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseCode"/>
                            </ns8:ResponseCode>
                        </ns10:Header>
                        <ns10:Body>
                            <ns4:TelcoOperationResponse>
                                <Id>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Id"/>
                                </Id>
                                <Name>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                                </Name>
                                <OrderId>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:OrderId"/>
                                </OrderId>
                                <StatusCode>
                                    <xsl:value-of select="$Response/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseCode"/>
                                </StatusCode>
                                <StatusMessage>
                                    <xsl:value-of select="$Response/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ErrorDescription"/>
                                </StatusMessage>
                            </ns4:TelcoOperationResponse>
                        </ns10:Body>
                    </ns9:ServiceReply>
                </ns9:Request>
            </Input>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="GetOrderManagementRoute">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>206</pd:x>
        <pd:y>196</pd:y>
        <config>
            <processName>/Domains/OrderManagement/CommonResources/Processes/OrderManagement/GetOrderManagementRoute.process</processName>
        </config>
        <pd:coercions>
            <pd:coercion xpath="$Start/Input/pfx:RequestEAI/pfx:Body/*" element="ns4:TelcoOperationRequest"/>
        </pd:coercions>
        <pd:inputBindings>
            <ns12:OrderManagementRoute>
                <ns12:OSM>
                    <ns12:OrderComponentName>
                        <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                    </ns12:OrderComponentName>
                    <ns12:ScenarioName>
                        <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Scenario"/>
                    </ns12:ScenarioName>
                </ns12:OSM>
            </ns12:OrderManagementRoute>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Logger [AUDIT] [END]">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>873</pd:x>
        <pd:y>571</pd:y>
        <config>
            <processName>/GlobalCommonResources/Processes/Logging/Logger.process</processName>
            <processNameXPath/>
        </config>
        <pd:inputBindings>
            <Input>
                <ns3:LogMessage>
                    <ns3:Source>
                        <xsl:value-of select="$SetHeader/Output/Header/ns:SourceSystem"/>
                    </ns3:Source>
                    <ns3:Target>
                        <xsl:value-of select="$SetHeader/Output/Header/ns:TargetSystem"/>
                    </ns3:Target>
                    <ns3:Process>
                        <xsl:value-of select="BW:getCurrentProcessName($_processContext/ns1:ProcessContext/ProcessId)"/>
                    </ns3:Process>
                    <ns3:Service>
                        <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:SourceSystem"/>
                    </ns3:Service>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:BusinessInterface/ns:Operation">
                        <ns3:Operation>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:BusinessInterface/ns:Operation"/>
                        </ns3:Operation>
                    </xsl:if>
                    <xsl:if test="$SetHeader/Output/Header/ns:RequestId">
                        <ns3:MsgId>
                            <xsl:value-of select="$SetHeader/Output/Header/ns:RequestId"/>
                        </ns3:MsgId>
                    </xsl:if>
                    <ns3:Type>
                        <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/Logging/Roles/AuditRoleName"/>
                    </ns3:Type>
                    <ns3:Task>
                        <xsl:value-of select="&quot;END ORDER COMPONENT&quot;"/>
                    </ns3:Task>
                    <ns3:Description>
                        <xsl:value-of select="&quot;Order Component Reply Message at END of process&quot;"/>
                    </ns3:Description>
                    <xsl:if test="$Response/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ErrorCode">
                        <ns3:ErrorCode>
                            <xsl:value-of select="$Response/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ErrorCode"/>
                        </ns3:ErrorCode>
                    </xsl:if>
                    <ns3:ResponseCode>
                        <xsl:value-of select="$Response/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseCode"/>
                    </ns3:ResponseCode>
                    <ns3:MessageBody>
                        <xsl:value-of select="tib:render-xml($Response/ns7:ResponseEAI)"/>
                    </ns3:MessageBody>
                    <xsl:if test="$SetHeader/Output/Header/ns:CorrelationId">
                        <ns3:CorrelationId>
                            <xsl:value-of select="$SetHeader/Output/Header/ns:CorrelationId"/>
                        </ns3:CorrelationId>
                    </xsl:if>
                    <ns3:UserName>
                        <xsl:value-of select="$SetHeader/Output/Header/ns:Credentials[1]/ns:User"/>
                    </ns3:UserName>
                    <xsl:if test="$SetHeader/Output/Header/ns:BusinessInterface/ns:Version">
                        <ns3:Version>
                            <xsl:value-of select="$SetHeader/Output/Header/ns:BusinessInterface/ns:Version"/>
                        </ns3:Version>
                    </xsl:if>
                    <ns3:Interface>
                        <xsl:value-of select="$Response/ns7:ResponseEAI/ns7:Header/ns:TechnicalInterface/ns:Interface"/>
                    </ns3:Interface>
                </ns3:LogMessage>
            </Input>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Logger [AUDIT][START]">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>491</pd:x>
        <pd:y>206</pd:y>
        <config>
            <processName>/GlobalCommonResources/Processes/Logging/Logger.process</processName>
            <processNameXPath/>
        </config>
        <pd:inputBindings>
            <Input>
                <ns3:LogMessage>
                    <ns3:Source>
                        <xsl:value-of select="$SetHeader/Output/Header/ns:SourceSystem"/>
                    </ns3:Source>
                    <ns3:Target>
                        <xsl:value-of select="$SetHeader/Output/Header/ns:TargetSystem"/>
                    </ns3:Target>
                    <ns3:Process>
                        <xsl:value-of select="BW:getCurrentProcessName($_processContext/ns1:ProcessContext/ProcessId)"/>
                    </ns3:Process>
                    <ns3:Service>
                        <xsl:value-of select="$SetHeader/Output/Header/ns:BusinessInterface/ns:Service"/>
                    </ns3:Service>
                    <ns3:Operation>
                        <xsl:value-of select="$SetHeader/Output/Header/ns:BusinessInterface/ns:Operation"/>
                    </ns3:Operation>
                    <xsl:if test="$SetHeader/Output/Header/ns:RequestId">
                        <ns3:MsgId>
                            <xsl:value-of select="$SetHeader/Output/Header/ns:RequestId"/>
                        </ns3:MsgId>
                    </xsl:if>
                    <ns3:Type>
                        <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/Logging/Roles/AuditRoleName"/>
                    </ns3:Type>
                    <ns3:Task>
                        <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/Logging/Tasks/Adapter/Start"/>
                    </ns3:Task>
                    <ns3:Description>
                        <xsl:value-of select="&quot;Start Business Dispatcher&quot;"/>
                    </ns3:Description>
                    <ns3:MessageBody>
                        <xsl:value-of select="tib:render-xml($Start/Input/pfx:RequestEAI)"/>
                    </ns3:MessageBody>
                    <xsl:if test="$SetHeader/Output/Header/ns:CorrelationId">
                        <ns3:CorrelationId>
                            <xsl:value-of select="$SetHeader/Output/Header/ns:CorrelationId"/>
                        </ns3:CorrelationId>
                    </xsl:if>
                    <ns3:UserName>
                        <xsl:value-of select="$SetHeader/Output/Header/ns:Credentials[1]/ns:User"/>
                    </ns3:UserName>
                    <xsl:if test="$SetHeader/Output/Header/ns:BusinessInterface/ns:Version">
                        <ns3:Version>
                            <xsl:value-of select="$SetHeader/Output/Header/ns:BusinessInterface/ns:Version"/>
                        </ns3:Version>
                    </xsl:if>
                    <xsl:if test="$SetHeader/Output/Header/ns:TechnicalInterface/ns:Interface">
                        <ns3:Interface>
                            <xsl:value-of select="$SetHeader/Output/Header/ns:TechnicalInterface/ns:Interface"/>
                        </ns3:Interface>
                    </xsl:if>
                </ns3:LogMessage>
            </Input>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Logger [ERROR]">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>583</pd:x>
        <pd:y>563</pd:y>
        <config>
            <processName>/GlobalCommonResources/Processes/Logging/Logger.process</processName>
            <processNameXPath/>
        </config>
        <pd:inputBindings>
            <Input>
                <xsl:choose>
                    <xsl:when test="string-length($Catch-LogMessage/ns3:LogMessage) > 0">
                        <xsl:copy-of select="$Catch-LogMessage/ns3:LogMessage"/>
                    </xsl:when>
                    <xsl:otherwise>
                        <ns3:LogMessage>
                            <ns3:Source>
                                <xsl:value-of select="$SetHeader/Output/Header/ns:SourceSystem"/>
                            </ns3:Source>
                            <ns3:Target>
                                <xsl:value-of select="$SetHeader/Output/Header/ns:TargetSystem"/>
                            </ns3:Target>
                            <ns3:Process>
                                <xsl:value-of select="BW:getCurrentProcessName($_processContext/ns1:ProcessContext/ProcessId)"/>
                            </ns3:Process>
                            <ns3:Service>
                                <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:BusinessInterface/ns:Service"/>
                            </ns3:Service>
                            <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:BusinessInterface/ns:Operation">
                                <ns3:Operation>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:BusinessInterface/ns:Operation"/>
                                </ns3:Operation>
                            </xsl:if>
                            <xsl:if test="$SetHeader/Output/Header/ns:RequestId">
                                <ns3:MsgId>
                                    <xsl:value-of select="$SetHeader/Output/Header/ns:RequestId"/>
                                </ns3:MsgId>
                            </xsl:if>
                            <ns3:Type>
                                <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/Logging/Roles/ErrorRoleName"/>
                            </ns3:Type>
                            <ns3:Task>
                                <xsl:value-of select="tib:substring-after-last($_error/ns1:ErrorReport/ProcessStack, &quot;/&quot;)"/>
                            </ns3:Task>
                            <ns3:Description>
                                <xsl:value-of select="$Response/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ErrorDescription"/>
                            </ns3:Description>
                            <ns3:ErrorDump>
                                <xsl:value-of select="$_error/ns1:ErrorReport/StackTrace"/>
                            </ns3:ErrorDump>
                            <xsl:if test="$Response/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ErrorCode">
                                <ns3:ErrorCode>
                                    <xsl:value-of select="$Response/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ErrorCode"/>
                                </ns3:ErrorCode>
                            </xsl:if>
                            <ns3:ResponseCode>
                                <xsl:value-of select="$Response/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseCode"/>
                            </ns3:ResponseCode>
                            <xsl:if test="$SetHeader/Output/Header/ns:CorrelationId">
                                <ns3:CorrelationId>
                                    <xsl:value-of select="$SetHeader/Output/Header/ns:CorrelationId"/>
                                </ns3:CorrelationId>
                            </xsl:if>
                            <ns3:UserName>
                                <xsl:value-of select="$SetHeader/Output/Header/ns:Credentials[1]/ns:User"/>
                            </ns3:UserName>
                            <xsl:if test="$SetHeader/Output/Header/ns:BusinessInterface/ns:Version">
                                <ns3:Version>
                                    <xsl:value-of select="$SetHeader/Output/Header/ns:BusinessInterface/ns:Version"/>
                                </ns3:Version>
                            </xsl:if>
                            <xsl:if test="$SetHeader/Output/Header/ns:TechnicalInterface/ns:Interface">
                                <ns3:Interface>
                                    <xsl:value-of select="$SetHeader/Output/Header/ns:TechnicalInterface/ns:Interface"/>
                                </ns3:Interface>
                            </xsl:if>
                        </ns3:LogMessage>
                    </xsl:otherwise>
                </xsl:choose>
            </Input>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Null">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>204</pd:x>
        <pd:y>364</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="Order Component Dispacher">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>793</pd:x>
        <pd:y>210</pd:y>
        <config>
            <processName>/GlobalCommonResources/Processes/Common/InterfaceService.process</processName>
            <processNameXPath>if ($Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute[ns:Name =  $_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/HasPipeline  ]/ns:Value = 'Y')  
	then 			
concat("/",$_globalVariables/ns2:GlobalVariables/Domains/BaseLocation, "/",$_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/Location, "/", $_globalVariables/ns2:GlobalVariables/Constants/Layer/Business, "/",$_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Location,"/",$GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:OSMAdapter/ns12:ResponseService[1])
else
concat("/",$_globalVariables/ns2:GlobalVariables/Domains/BaseLocation, "/",$_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/Location, "/", $_globalVariables/ns2:GlobalVariables/Constants/Layer/Business, "/",$_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Location,"/", $GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:OSMAdapter/ns12:Domain,"/",$GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:OSMAdapter/ns12:TargetSystem,"/",$GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:OSMAdapter/ns12:Operation,"_v",$GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:OSMAdapter/ns12:Version,"/",$GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:OSMAdapter/ns12:Operation,".process")</processNameXPath>
        </config>
        <pd:inputBindings>
            <Input>
                <pfx:RequestEAI>
                    <pfx:Header>
                        <xsl:copy-of select="$SetHeader/Output/Header/ancestor-or-self::*/namespace::node()"/>
                        <xsl:copy-of select="$SetHeader/Output/Header/@*"/>
                        <xsl:copy-of select="$SetHeader/Output/Header/node()"/>
                    </pfx:Header>
                    <pfx:Body>
                        <xsl:choose>
                            <xsl:when test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute[ns:Name =  $_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/HasPipeline ]/ns:Value = 'Y'">
                                <ns9:Request>
                                    <ns9:OcDetails>
                                        <ns9:Id>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Id"/>
                                        </ns9:Id>
                                        <ns9:Name>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                                        </ns9:Name>
                                        <ns9:Scenario>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Scenario"/>
                                        </ns9:Scenario>
                                        <ns9:OrderId>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:OrderId"/>
                                        </ns9:OrderId>
                                        <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:MasterOrderId">
                                            <ns9:MasterOrderId>
                                                <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:MasterOrderId"/>
                                            </ns9:MasterOrderId>
                                        </xsl:if>
                                        <ns9:CorrelationID>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute[ns:Name = $_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/CorrelationID]/ns:Value"/>
                                        </ns9:CorrelationID>
                                        <xsl:for-each select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Cartridge">
                                            <ns9:Cartridge>
                                                <ns9:Name>
                                                    <xsl:value-of select="ns4:Name"/>
                                                </ns9:Name>
                                                <ns9:Version>
                                                    <xsl:value-of select="ns4:Version"/>
                                                </ns9:Version>
                                                <ns9:Source>
                                                    <xsl:value-of select="ns4:Source"/>
                                                </ns9:Source>
                                            </ns9:Cartridge>
                                        </xsl:for-each>
                                    </ns9:OcDetails>
                                    <ns9:ServiceReply>
                                        <ns10:Header>
                                            <ns8:ResponseCode>
                                                <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/ErrorCodes/Success"/>
                                            </ns8:ResponseCode>
                                            <ns8:Attributes>
                                                <ns8:Attribute>
                                                    <ns8:Name>
                                                        <xsl:value-of select="'RootId'"/>
                                                    </ns8:Name>
                                                    <ns8:Value>
                                                        <xsl:value-of select="($Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:XMLMessage/*[1]//RootItemId)[1]"/>
                                                    </ns8:Value>
                                                </ns8:Attribute>
                                                <ns8:Attribute>
                                                    <ns8:Name>
                                                        <xsl:value-of select="'OperationName'"/>
                                                    </ns8:Name>
                                                    <ns8:Value>
                                                        <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Pipeline/ns4:PipelineItem[ns4:OperationId=../../ns4:Id]/ns4:OperationName"/>
                                                    </ns8:Value>
                                                </ns8:Attribute>
                                            </ns8:Attributes>
                                        </ns10:Header>
                                        <ns10:Body>
                                            <xsl:copy-of select="$Parse-XML/*/*"/>
                                        </ns10:Body>
                                    </ns9:ServiceReply>
                                </ns9:Request>
                            </xsl:when>
                            <xsl:otherwise>
                                <ns11:Request>
                                    <ns11:OrderComponentDetails>
                                        <ns11:Id>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Id"/>
                                        </ns11:Id>
                                        <ns11:Name>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                                        </ns11:Name>
                                        <ns11:Scenario>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Scenario"/>
                                        </ns11:Scenario>
                                        <ns11:OrderId>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:OrderId"/>
                                        </ns11:OrderId>
                                        <ns11:MasterOrderId>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:MasterOrderId"/>
                                        </ns11:MasterOrderId>
                                        <ns11:NumberOfRetries>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:NumberOfRetries"/>
                                        </ns11:NumberOfRetries>
                                        <ns11:CorrelationID>
                                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute[ns:Name = $_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/CorrelationID]/ns:Value"/>
                                        </ns11:CorrelationID>
                                        <xsl:for-each select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Cartridge">
                                            <ns11:Cartridge>
                                                <ns11:Name>
                                                    <xsl:value-of select="ns4:Name"/>
                                                </ns11:Name>
                                                <ns11:Version>
                                                    <xsl:value-of select="ns4:Version"/>
                                                </ns11:Version>
                                                <ns11:Source>
                                                    <xsl:value-of select="ns4:Source"/>
                                                </ns11:Source>
                                            </ns11:Cartridge>
                                        </xsl:for-each>
                                        <ns11:XMLMessage>
                                            <xsl:copy-of select="$Remove-Namespaces/xmlString"/>
                                        </ns11:XMLMessage>
                                        <xsl:for-each select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Pipeline">
                                            <ns11:Pipeline>
                                                <xsl:for-each select="ns4:PipelineItem">
                                                    <ns11:PipelineItem>
                                                        <ns11:OperationId>
                                                            <xsl:value-of select="ns4:OperationId"/>
                                                        </ns11:OperationId>
                                                        <ns11:OperationName>
                                                            <xsl:value-of select="ns4:OperationName"/>
                                                        </ns11:OperationName>
                                                        <ns11:PipelineMessage>
                                                            <xsl:copy-of select="ns4:PipelineMessage"/>
                                                        </ns11:PipelineMessage>
                                                    </ns11:PipelineItem>
                                                </xsl:for-each>
                                            </ns11:Pipeline>
                                        </xsl:for-each>
                                    </ns11:OrderComponentDetails>
                                    <ns11:ServiceCatalogQueue>
                                        <xsl:value-of select="$GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:ServiceCatalog/ns12:Queue"/>
                                    </ns11:ServiceCatalogQueue>
                                </ns11:Request>
                            </xsl:otherwise>
                        </xsl:choose>
                    </pfx:Body>
                </pfx:RequestEAI>
            </Input>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Remove Namespaces">
        <pd:type>com.tibco.plugin.xml.XMLTransformActivity</pd:type>
        <pd:resourceType>ae.activities.XMLTransformActivity</pd:resourceType>
        <pd:x>628</pd:x>
        <pd:y>198</pd:y>
        <config>
            <inputStyle>text</inputStyle>
            <engine>TibcoXML</engine>
            <stylesheet>/Domains/OrderManagement/CommonResources/Transformations/Remove Namespaces.xslt</stylesheet>
        </config>
        <pd:inputBindings>
            <textInput>
                <xmlString>
                    <xsl:value-of select="tib:render-xml($Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:XMLMessage/*[1])"/>
                </xmlString>
            </textInput>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="SetHeader">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>352</pd:x>
        <pd:y>199</pd:y>
        <config>
            <processName>/GlobalCommonResources/Processes/Common/SetHeader.process</processName>
        </config>
        <pd:inputBindings>
            <Input>
                <Header>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:RequestId">
                        <ns:RequestId>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:RequestId"/>
                        </ns:RequestId>
                    </xsl:if>
                    <ns:SourceSystem>
                        <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:SourceSystem"/>
                    </ns:SourceSystem>
                    <ns:ReplyExpected>
                        <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:ReplyExpected"/>
                    </ns:ReplyExpected>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:QoS">
                        <ns:QoS>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:QoS"/>
                        </ns:QoS>
                    </xsl:if>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Schedule">
                        <ns:Schedule>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Schedule"/>
                        </ns:Schedule>
                    </xsl:if>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:CorrelationId">
                        <ns:CorrelationId>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:CorrelationId"/>
                        </ns:CorrelationId>
                    </xsl:if>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Priority">
                        <ns:Priority>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Priority"/>
                        </ns:Priority>
                    </xsl:if>
                    <xsl:copy-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Credentials"/>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:ProxySystem">
                        <ns:ProxySystem>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:ProxySystem"/>
                        </ns:ProxySystem>
                    </xsl:if>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:ForceSimulate">
                        <ns:ForceSimulate>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:ForceSimulate"/>
                        </ns:ForceSimulate>
                    </xsl:if>
                    <ns:Attributes>
                        <xsl:for-each select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute">
                            <ns:Attribute>
                                <ns:Name>
                                    <xsl:value-of select="ns:Name"/>
                                </ns:Name>
                                <ns:Value>
                                    <xsl:value-of select="ns:Value"/>
                                </ns:Value>
                            </ns:Attribute>
                        </xsl:for-each>
                        <ns:Attribute>
                            <ns:Name>
                                <xsl:value-of select="$_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/ResponseService"/>
                            </ns:Name>
                            <ns:Value>
                                <xsl:value-of select="$GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:OSMAdapter/ns12:ResponseService"/>
                            </ns:Value>
                        </ns:Attribute>
                    </ns:Attributes>
                    <ns:BusinessInterface>
                        <ns:Service>
                            <xsl:value-of select="$GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:ServiceCatalog/ns12:Service"/>
                        </ns:Service>
                        <ns:Operation>
                            <xsl:value-of select="$GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:ServiceCatalog/ns12:Operation"/>
                        </ns:Operation>
                        <ns:Version>
                            <xsl:value-of select="$GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]/ns12:ServiceCatalog/ns12:Version"/>
                        </ns:Version>
                    </ns:BusinessInterface>
                    <xsl:copy-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:TechnicalInterface"/>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:TargetSystem">
                        <ns:TargetSystem>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:TargetSystem"/>
                        </ns:TargetSystem>
                    </xsl:if>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:CreationTimestamp">
                        <ns:CreationTimestamp>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:CreationTimestamp"/>
                        </ns:CreationTimestamp>
                    </xsl:if>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:TimeOut">
                        <ns:TimeOut>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:TimeOut"/>
                        </ns:TimeOut>
                    </xsl:if>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Tries">
                        <ns:Tries>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Tries"/>
                        </ns:Tries>
                    </xsl:if>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:MaxTries">
                        <ns:MaxTries>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:MaxTries"/>
                        </ns:MaxTries>
                    </xsl:if>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Repub">
                        <ns:Repub>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Repub"/>
                        </ns:Repub>
                    </xsl:if>
                    <xsl:if test="$Start/Input/pfx:RequestEAI/pfx:Header/ns:RepubTime">
                        <ns:RepubTime>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:RepubTime"/>
                        </ns:RepubTime>
                    </xsl:if>
                    <xsl:copy-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:History"/>
                    <xsl:copy-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Transport"/>
                </Header>
            </Input>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Parse XML">
        <pd:type>com.tibco.plugin.xml.XMLParseActivity</pd:type>
        <pd:resourceType>ae.activities.XMLParseActivity</pd:resourceType>
        <pd:x>622</pd:x>
        <pd:y>292</pd:y>
        <config>
            <inputStyle>text</inputStyle>
            <xsdVersion>default</xsdVersion>
            <validateOutput>false</validateOutput>
            <term>
                <xsd:any processContents="skip"/>
            </term>
        </config>
        <pd:inputBindings>
            <xmlString>
                <xsl:value-of select="tib:render-xml($Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Pipeline/ns4:PipelineItem[ns4:OperationId=../../ns4:Id]/ns4:PipelineMessage)"/>
            </xmlString>
        </pd:inputBindings>
    </pd:activity>
    <pd:activity name="Null-1">
        <pd:type>com.tibco.plugin.timer.NullActivity</pd:type>
        <pd:resourceType>ae.activities.null</pd:resourceType>
        <pd:x>324</pd:x>
        <pd:y>309</pd:y>
        <config/>
        <pd:inputBindings/>
    </pd:activity>
    <pd:activity name="Close Order Component">
        <pd:type>com.tibco.pe.core.CallProcessActivity</pd:type>
        <pd:resourceType>ae.process.subprocess</pd:resourceType>
        <pd:x>791</pd:x>
        <pd:y>86</pd:y>
        <config>
            <processName>/Domains/OrderManagement/BusinessResources/Processes/OrderComponent/OrderComponentResponse.process</processName>
        </config>
        <pd:inputBindings>
            <Input>
                <ns9:Request>
                    <ns9:OcDetails>
                        <ns9:Id>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Id"/>
                        </ns9:Id>
                        <ns9:Name>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                        </ns9:Name>
                        <ns9:Scenario>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Scenario"/>
                        </ns9:Scenario>
                        <ns9:OrderId>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:OrderId"/>
                        </ns9:OrderId>
                        <ns9:CorrelationID>
                            <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute[ns:Name = $_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/CorrelationID]/ns:Value"/>
                        </ns9:CorrelationID>
                        <xsl:for-each select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Cartridge">
                            <ns9:Cartridge>
                                <ns9:Name>
                                    <xsl:value-of select="ns4:Name"/>
                                </ns9:Name>
                                <ns9:Version>
                                    <xsl:value-of select="ns4:Version"/>
                                </ns9:Version>
                                <ns9:Source>
                                    <xsl:value-of select="ns4:Source"/>
                                </ns9:Source>
                            </ns9:Cartridge>
                        </xsl:for-each>
                    </ns9:OcDetails>
                    <ns9:ServiceReply>
                        <ns10:Header>
                            <ns8:ResponseCode>
                                <xsl:value-of select="$Order-Component-Dispacher/Output/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseCode"/>
                            </ns8:ResponseCode>
                        </ns10:Header>
                        <ns10:Body>
                            <ns4:TelcoOperationResponse>
                                <Id>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Id"/>
                                </Id>
                                <Name>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:Name"/>
                                </Name>
                                <OrderId>
                                    <xsl:value-of select="$Start/Input/pfx:RequestEAI/pfx:Body/ns4:TelcoOperationRequest/ns4:OrderId"/>
                                </OrderId>
                                <StatusCode>
                                    <xsl:value-of select="$Order-Component-Dispacher/Output/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseCode"/>
                                </StatusCode>
                                <StatusMessage>
                                    <xsl:value-of select="tib:left($Order-Component-Dispacher/Output/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseMsg, 1000)"/>
                                </StatusMessage>
                            </ns4:TelcoOperationResponse>
                        </ns10:Body>
                    </ns9:ServiceReply>
                </ns9:Request>
            </Input>
        </pd:inputBindings>
    </pd:activity>
    <pd:transition>
        <pd:from>Start</pd:from>
        <pd:to>GetOrderManagementRoute</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>SetHeader</pd:from>
        <pd:to>Logger [AUDIT][START]</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Order Component Dispacher</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>GetOrderManagementRoute</pd:from>
        <pd:to>SetHeader</pd:to>
        <pd:xpathDescription>Found Configuration</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Order Component Dispacher</pd:from>
        <pd:to>Fail Order Component</pd:to>
        <pd:xpathDescription>Error</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-65536</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Order-Component-Dispacher/Output/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseCode !=$_globalVariables/ns2:GlobalVariables/ErrorCodes/Success</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Fail Order Component</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Catch-LogMessage</pd:from>
        <pd:to>Assign Error</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Catch-All</pd:from>
        <pd:to>Assign Error</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Assign Error</pd:from>
        <pd:to>Logger [ERROR]</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Logger [ERROR]</pd:from>
        <pd:to>Fail Order Component - 1</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Logger [AUDIT] [END]</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>GetOrderManagementRoute</pd:from>
        <pd:to>Null</pd:to>
        <pd:xpathDescription>Order Component not configured</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-65536</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>string-length($GetOrderManagementRoute/Routes/ns12:OrderManagementRoute[1]) = 0</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Null</pd:from>
        <pd:to>Fail Order Component</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-65536</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Fail Order Component - 1</pd:from>
        <pd:to>Logger [AUDIT] [END]</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Logger [AUDIT][START]</pd:from>
        <pd:to>Remove Namespaces</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>otherwise</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Remove Namespaces</pd:from>
        <pd:to>Order Component Dispacher</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Logger [AUDIT][START]</pd:from>
        <pd:to>Parse XML</pd:to>
        <pd:xpathDescription>Has Pipeline</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute[ns:Name =  $_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/HasPipeline  ]/ns:Value = 'Y'</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Parse XML</pd:from>
        <pd:to>Order Component Dispacher</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>GetOrderManagementRoute</pd:from>
        <pd:to>Null-1</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-65485</pd:lineColor>
        <pd:conditionType>error</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Null-1</pd:from>
        <pd:to>Fail Order Component</pd:to>
        <pd:lineType>Multiple Bends</pd:lineType>
        <pd:lineColor>-65485</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
    <pd:transition>
        <pd:from>Order Component Dispacher</pd:from>
        <pd:to>Close Order Component</pd:to>
        <pd:xpathDescription>Success reprocessing TS Response</pd:xpathDescription>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>xpath</pd:conditionType>
        <pd:xpath>$Start/Input/pfx:RequestEAI/pfx:Header/ns:Attributes/ns:Attribute[ns:Name =  $_globalVariables/ns2:GlobalVariables/Domains/OrderManagement/OrderComponent/Constants/HasPipeline  ]/ns:Value = 'Y'
and
$Order-Component-Dispacher/Output/ns7:ResponseEAI/ns7:ResponseCodes/ns8:ResponseCode = $_globalVariables/ns2:GlobalVariables/ErrorCodes/Success</pd:xpath>
    </pd:transition>
    <pd:transition>
        <pd:from>Close Order Component</pd:from>
        <pd:to>End</pd:to>
        <pd:lineType>Default</pd:lineType>
        <pd:lineColor>-16777216</pd:lineColor>
        <pd:conditionType>always</pd:conditionType>
    </pd:transition>
</pd:ProcessDefinition>